@using globals.Models
@namespace YourProjectNamespace.Modules

<div class="row">
    <div class="col-12">
        <div class="tm-categories-container">
            <h3 class="tm-text-primary tm-categories-text">Categories:</h3>
            <ul class="nav tm-category-list" role="tablist">
                <li class="nav-item tm-category-item" role="presentation">
                    <button id="home-tab" data-toggle="tab" data-target="#home" type="button" role="tab" aria-controls="home" aria-selected="true" class="nav-link active tm-category-link active" @onclick="@(() => FilterBestellungen("alle"))">Alle</button>
                </li>
                <li class="nav-item tm-category-item" role="presentation">
                    <button id="neue-tab" data-toggle="tab" data-target="#neue" type="button" role="tab" aria-controls="neue" aria-selected="false" @onclick="@(() => FilterBestellungen("neue"))" class="nav-link tm-category-link">Neue</button>
                </li>
                <li class="nav-item tm-category-item" role="presentation">
                    <button id="bestatigte-tab" data-toggle="tab" data-target="#bestatigte" type="button" role="tab" aria-controls="bestatigte" aria-selected="false" @onclick="@(() => FilterBestellungen("bestätigte"))" class="nav-link tm-category-link">Bestätigte</button>
                </li>
                <li class="nav-item tm-category-item" role="presentation">
                    <button id="gedruckt-tab" data-toggle="tab" data-target="#gedruckt" type="button" role="tab" aria-controls="gedruckt" aria-selected="false" @onclick="@(() => FilterBestellungen("gedruckt"))" class="nav-link tm-category-link">Etiketten gedruckt</button>
                </li>
                <li class="nav-item tm-category-item" role="presentation">
                    <button id="reservierung-tab" data-toggle="tab" data-target="#reservierung" type="button" role="tab" aria-controls="reservierung" aria-selected="false" class="nav-link tm-category-link">Reservierung</button>
                </li>
                <li class="nav-item tm-category-item" role="presentation">
                    <button id="vorschau-tab" data-toggle="tab" data-target="#vorschau" type="button" role="tab" aria-controls="vorschau" aria-selected="false" class="nav-link tm-category-link">Vorschau</button>
                </li>
            </ul>
        </div>
    </div>
</div>


<div class="table-responsive custom_table tab-content" id="myTabContent">
    <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
        <table class="table table-striped table-sm">
            <thead class="table-dark">
                <tr>
                    <th></th>
                    <th>Lfd. Nr.</th>
                    <th>Ankäufer</th>
                    <th>Datum</th>
                    <th>Zeit</th>
                    <th>Kunde</th>
                    <th>Artikel</th>
                    <th>VP</th>
                    <th>Menge</th>
                    <th>Preis</th>
                    <th>Bemerkung</th>
                    <th>Container</th>
                    <th>Besteller</th>
                    <th>Status</th>
                    <th>Stk/cc</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var bestellung in _filteredBestellungen)
                {
                    <tr class="@GetStatusClass(bestellung.Status_bg)">
                        <th>
                            <label class="switch">
                                <input type="checkbox" class="childCheckbox">
                                <span class="slider"></span>
                            </label>
                        </th>
                        <td>@bestellung.LfdNr</td>
                        <td>@bestellung.Ankaeufer</td>
                        <td>@bestellung.Datum.ToString("dd.MM.yyyy")</td>
                        <td>@bestellung.Zeit.ToString("HH:mm")</td>
                        <td>@bestellung.Kunde</td>
                        <td>@bestellung.Artikel</td>
                        <td>@bestellung.VP</td>
                        <td>@bestellung.Menge</td>
                        <td>@bestellung.Einzelpreis</td>
                        <td>@bestellung.Bemerkung</td>
                        <td>@bestellung.Container</td>
                        <td>@bestellung.Besteller</td>
                        <td>@bestellung.Status_bg</td>
                        <td>@bestellung.StkCC</td>
                    </tr>
                }
            </tbody>
        </table>
        <div class="bottom_links">
            <label class="switch">
                <input type="checkbox" id="mainCheckbox">
                <span class="slider"></span>
            </label>
            Alle Auswählen
        </div>
    </div>
    <div class="tab-pane fade" id="neue" role="tabpanel" aria-labelledby="neue-tab">
        <Ubersicht />
    </div>
    <!-- Другие вкладки остаются без изменений -->
</div>

@code {
    private List<Bestellung> _allBestellungen = new List<Bestellung>();
    private List<Bestellung> _filteredBestellungen = new List<Bestellung>();

    protected override async Task OnInitializedAsync()
    {
        SetDemoData();
        FilterBestellungen("alle"); // Показываем все заказы по умолчанию
    }

    private void SetDemoData()
    {
        _allBestellungen.Clear();

        _allBestellungen.Add(new Bestellung
        {
            LfdNr = 382218,
            Ankaeufer = "elbers",
            Datum = DateTime.Now,
            Zeit = DateTime.Now,
            Kunde = "6",
            Artikel = "Call vulg. GG Sunset Trio 11 cm Trio",
            VP = "DN",
            Menge = "80 X 8",
            StueckJePalette = 8,
            GesamtanzahlNetto = 640,
            Einzelpreis = 1.5,
            Bemerkung = "Bemerkung für diese Bestellung",
            Container = "Tag 5",
            Besteller = "Daniel",
            Status_bg = "gedruckt",
            StkCC = 40
        });

        _allBestellungen.Add(new Bestellung
        {
            LfdNr = 382219, // Убедитесь, что этот номер уникален
            Ankaeufer = "elbers",
            Datum = DateTime.Now,
            Zeit = DateTime.Now,
            Kunde = "22",
            Artikel = "* Ampelpflanzen  xyz",
            VP = "DN",
            Menge = "42 X 4",
            StueckJePalette = 4,
            GesamtanzahlNetto = 40,
            Einzelpreis = 2.5,
            Bemerkung = "Bemerkung für diese Bestellung",
            Container = "Tag 2",
            Besteller = "Daniel",
            Status_bg = "bestätigt",
            StkCC = 20
        });

        _allBestellungen.Add(new Bestellung
        {
            LfdNr = 382220, // Уникальный номер
            Ankaeufer = "test test",
            Datum = DateTime.Now,
            Zeit = DateTime.Now,
            Kunde = "777",
            Artikel = "Item",
            VP = "DN",
            Menge = "7 X 5",
            StueckJePalette = 4,
            GesamtanzahlNetto = 40,
            Einzelpreis = 2.5,
            Bemerkung = "Bemerkung für diese Bestellung",
            Container = "Tag 10",
            Besteller = "John Doi",
            Status_bg = "neu",
            StkCC = 20
        });
    }

    public void FilterBestellungen1(int status1)
    {
       
    }
    public void FilterBestellungen(string status)
    {
        _filteredBestellungen = status switch
        {
            "neue" => _allBestellungen.Where(b => b.Status_bg == "neu").ToList(),
            "bestätigte" => _allBestellungen.Where(b => b.Status_bg == "bestätigt").ToList(),
            "gedruckt" => _allBestellungen.Where(b => b.Status_bg == "gedruckt").ToList(),
            _ => _allBestellungen // Показываем все заказы
        };
    }

    private string GetStatusClass(string status)
    {
        return status switch
        {
            "gedruckt" => "table-success",
            "bestätigt" => "table-danger",
            "neu" => "table-primary",
            _ => ""
        };
    }
}
